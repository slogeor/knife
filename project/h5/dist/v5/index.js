$(function(){var e={continent:"",national:"",name:"",phoneNum:"",gender:"",age:"",skinColor:"",file:""};function n(e){return e.replace(/(^\s*)|(\s*$)/g,"")}function o(e){$("#err-msg").removeClass("autoHide").addClass("autoShow"),$("#msg-txt").html(e),setTimeout(()=>{console.log(11),i()},3e3)}function i(){$("#err-msg").addClass("autoHide").removeClass("autoShow")}$("#file").on("change",function(){!function(n,i,t){var l=document.getElementById(n);if(void 0!==l&&0!=l.files.length){console.log(l.files[0]);var a=l.files[0],s=a.type,c=a.size;if(console.log("fileType:",s),console.log("fileSize:",c),-1!==["image/jpeg","image/jpg","image/png","image/pjpeg"].indexOf(s))if(c>1048576)o("Upload file (<1M)");else{var r=new FileReader;r.readAsDataURL(a),r.onload=function(n){var o=n.target.result,l=document.getElementById(i);void 0!==l&&l.setAttribute("src",o);var a=document.getElementById(t);void 0!==a&&(a.setAttribute("value",o),e.file=o)}}else o("File format error，Only supports the format jpeg、png、jpg.")}else console.log("file "+n+" not exists")}("file","photo","fileVal"),$("#file").val("")}),$("#err-msg").on("click",function(){i()}),$("#join").on("click",function(){$("#join-wrap").hide(),$("#form-wrap").removeClass("hide")}),$("#submit").on("click",function(){e.continent=$("#continent").val(),e.national=$("#national").val(),e.name=$("#name").val(),e.phoneNum=$("#phoneNum").val(),e.gender=$("input[type='radio']:checked").val(),e.age=$("#age").val(),e.skinColor=$("#skinColor").val(),(n(e.continent)&&n(e.national)&&n(e.name)&&n(e.phoneNum)&&n(e.gender)&&n(e.age)&&n(e.skinColor)&&e.file||(o("Required field（*） cannot be empty"),0))&&$.ajax({type:"POST",url:"http://39.97.167.25:80/photo/manager",type:"post",cache:!1,dataType:"json",data:{...e},success:function(e){if(e.ret)return o("Successful submission"),console.log("success"),void $("#form-wrap").hide();o(e.msg)},error:function(e){o(e.msg)}})}),window.wxConfig.init(),window.wxConfig.wxShareConfig({title:"WE NEED YOU！",desc:"FR volunteer, waiting for you.",link:window.location.href.split("#")[0],imgUrl:"http://photo.qingfeichina.com/image/frc.jpg",onSuccess:function(){console.log("onSuccess")},onCancel:function(){console.log("onCancel")}})});
